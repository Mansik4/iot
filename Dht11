#include <WiFi.h>
#include "DHT.h"

#define DHTPIN 2  
#define DHTTYPE DHT11

DHT dht(DHTPIN, DHTTYPE);

const char* ssid = "YourWiFiName";
const char* password = "YourWiFiPassword";

WiFiServer server(80);

int ldrPin = 34;
int mq2Pin = 35;

void setup(){
  Serial.begin(115200);
  dht.begin();

  pinMode(ldrPin, INPUT);
  pinMode(mq2Pin, INPUT);

  WiFi.begin(ssid, password);
  while (WiFi.status() != WL_CONNECTED) {
    delay(500);
    Serial.print(".");
  }

  Serial.println("\nWiFi Connected!");
  Serial.print("IP Address: ");
  Serial.println(WiFi.localIP());

  server.begin();
}

void loop(){
  WiClient client = server.available();
  if(!client) return;

  while(!client.available()){ delay(1); }

  float temp = dht.readTemperature();
  float hum  = dht.readHumidity();
  int ldrVal = analogRead(ldrPin);
  int gasVal = analogRead(mq2Pin);

  String html = "<html><head><title>ESP32 Sensor Dashboard</title>";
  html += "<style>body{font-family:Arial;text-align:center;} .box{padding:10px;margin:8px;border:2px solid black; display:inline-block; }</style>";
  html += "</head><body>";
  html += "<h2>ESP32 Sensor Data Web Server</h2>";
  html += "<div class='box'>Temperature: " + String(temp) + " Â°C</div><br>";
  html += "<div class='box'>Humidity: " + String(hum) + " %</div><br>";
  html += "<div class='box'>Light Level: " + String(ldrVal) + "</div><br>";
  html += "<div class='box'>Gas Value: " + String(gasVal) + "</div><br>";
  html += "</body></html>";

  client.print("HTTP/1.1 200 OK\r\nContent-Type: text/html\r\n\r\n");
  client.print(html);
  delay(100);
}
